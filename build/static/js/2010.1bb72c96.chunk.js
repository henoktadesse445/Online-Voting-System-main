"use strict";(self.webpackChunkmyapp=self.webpackChunkmyapp||[]).push([[2010],{90028:(e,s,a)=>{a.r(s),a.d(s,{default:()=>m});a(57406),a(37354),a(99664);const t=a.p+"static/media/signin-image.6f1c72291c1ec0817ded.jpg";var r=a(65043),l=a(32040),o=a(77154),n=a(78745),i=(a(92342),a(73216)),d=a(39194),c=a(70579);const m=()=>{const e=(0,i.Zp)(),[s,a]=(0,r.useState)(""),[m,u]=(0,r.useState)(""),[h,g]=(0,r.useState)(!1),[p,x]=(0,r.useState)(!1),[j,v]=(0,r.useState)(""),[N,w]=(0,r.useState)({}),[f,P]=(0,r.useState)(""),[b,y]=(0,r.useState)(""),[S,R]=(0,r.useState)(""),[C,T]=(0,r.useState)(!1),[O,k]=(0,r.useState)(1),[z,A]=(0,r.useState)(""),[D,q]=(0,r.useState)(""),[I,F]=(0,r.useState)(""),[E,U]=(0,r.useState)(""),[Z,L]=(0,r.useState)(""),[W,$]=(0,r.useState)(""),[M,V]=(0,r.useState)(""),[_,Y]=(0,r.useState)(""),B=e=>n.oR.error(e||"Invalid Details or User Doesn't exist",{className:"toast-message"}),G=e=>{if(!e)return"";const s=/[A-Z]/.test(e),a=/[a-z]/.test(e),t=/\d/.test(e),r=/[!@#$%^&*()_+\-=\[\]{}|;:,.<>?]/.test(e),l=e.length;return l>=12&&s&&a&&t&&r?"strong":l>=10&&s&&a&&t&&r?"medium":l>=8&&s&&a&&t&&r?"weak":"invalid"},H=async()=>{g(!0);try{const a=await o.A.post("".concat(d.C,"/login"),{username:s,credential:m});if(a.data.success)if(a.data.requiresPasswordChange)v(a.data.userId),w(a.data.userInfo),x(!0),n.oR.info("Please set a new password to continue",{className:"toast-message"});else{const s=a.data.voterObject;n.oR.success("Login Success",{className:"toast-message"}),setTimeout((()=>{e("/User",{state:{voterst:s}})}),500)}else B(a.data.message)}catch(r){var a,t;console.error("Login failed:",r),B((null===(a=r.response)||void 0===a||null===(t=a.data)||void 0===t?void 0:t.message)||"Error during login")}finally{g(!1)}},J=async e=>{if(e.preventDefault(),z){g(!0);try{const e=await o.A.post("".concat(d.C,"/requestPasswordReset"),{username:z});e.data.success?(L(e.data.email),k(2),n.oR.success(e.data.message,{className:"toast-message"})):n.oR.error(e.data.message,{className:"toast-message"})}catch(t){var s,a;console.error("Request password reset failed:",t),n.oR.error((null===(s=t.response)||void 0===s||null===(a=s.data)||void 0===a?void 0:a.message)||"Error requesting password reset",{className:"toast-message"})}finally{g(!1)}}else n.oR.error("Please enter your Student ID",{className:"toast-message"})};return(0,c.jsxs)("div",{children:[(0,c.jsx)(l.A,{}),(0,c.jsx)("section",{className:"sign-in",children:(0,c.jsxs)("div",{className:"container",children:[(0,c.jsx)("p",{children:"Login with your Student ID or Email and OTP/Password"}),(0,c.jsxs)("div",{className:"signin-content",children:[(0,c.jsx)("div",{className:"signin-image",children:(0,c.jsx)("figure",{children:(0,c.jsx)("img",{src:t,alt:"sign in image"})})}),(0,c.jsxs)("div",{className:"signin-form",children:[(0,c.jsx)("h2",{className:"form-title",children:"Sign In"}),(0,c.jsx)(n.N9,{}),(0,c.jsxs)("form",{onSubmit:async e=>{e&&e.preventDefault(),s&&m?await H():B("Please enter both username and OTP/password")},children:[(0,c.jsxs)("div",{className:"form-group",children:[(0,c.jsx)("label",{htmlFor:"studentid",children:(0,c.jsx)("i",{className:"zmdi zmdi-account material-icons-name"})}),(0,c.jsx)("input",{type:"text",name:"studentid",id:"studentid",placeholder:"Student ID or Email (e.g., WCU1234567)",onChange:e=>a(e.target.value),value:s,required:!0})]}),(0,c.jsxs)("div",{className:"form-group",children:[(0,c.jsx)("label",{htmlFor:"credential",children:(0,c.jsx)("i",{className:"zmdi zmdi-lock"})}),(0,c.jsx)("input",{type:"password",name:"credential",id:"credential",placeholder:"Enter OTP or Password",onChange:e=>u(e.target.value),value:m,required:!0})]}),(0,c.jsx)("div",{className:"form-group form-button",children:(0,c.jsx)("button",{type:"submit",disabled:h,children:h?(0,c.jsx)("div",{className:"spinner"}):"Login"})}),(0,c.jsxs)("div",{className:"action-buttons-container",children:[(0,c.jsx)("button",{type:"button",onClick:async()=>{if(s){g(!0);try{const e=await o.A.post("".concat(d.C,"/resendOTP"),{username:s});e.data.success?n.oR.success(e.data.message||"OTP resent successfully. Please check your email.",{className:"toast-message"}):n.oR.error(e.data.message,{className:"toast-message"})}catch(t){var e,a;console.error("Resend OTP failed:",t),n.oR.error((null===(e=t.response)||void 0===e||null===(a=e.data)||void 0===a?void 0:a.message)||"Error resending OTP. Please try again later.",{className:"toast-message"})}finally{g(!1)}}else n.oR.error("Please enter your Student ID or Email first",{className:"toast-message"})},disabled:h,children:"Resend OTP?"}),(0,c.jsx)("button",{type:"button",onClick:()=>T(!0),children:"Forgot Password?"})]})]})]})]})]})}),p&&(0,c.jsx)("div",{className:"modal-overlay",children:(0,c.jsxs)("div",{className:"modal-content",children:[(0,c.jsx)("h2",{className:"modal-title",children:"Set Your Password"}),(0,c.jsxs)("p",{className:"modal-subtitle",children:["Welcome, ",(0,c.jsx)("strong",{children:N.name}),"! Please set a secure password for your account."]}),(0,c.jsxs)("form",{onSubmit:async s=>{if(s.preventDefault(),!f||!b)return void n.oR.error("Please fill in all password fields",{className:"toast-message"});if(f!==b)return void n.oR.error("Passwords do not match",{className:"toast-message"});if("invalid"!==G(f)){g(!0);try{const s=await o.A.post("".concat(d.C,"/setPassword"),{userId:j,newPassword:f,confirmPassword:b});if(s.data.success){const a=s.data.voterObject;n.oR.success("Password set successfully!",{className:"toast-message"}),x(!1),setTimeout((()=>{e("/User",{state:{voterst:a}})}),500)}else n.oR.error(s.data.message,{className:"toast-message"})}catch(r){var a,t;console.error("Password change failed:",r),n.oR.error((null===(a=r.response)||void 0===a||null===(t=a.data)||void 0===t?void 0:t.message)||"Error setting password",{className:"toast-message"})}finally{g(!1)}}else n.oR.error("Password must be at least 8 characters and contain uppercase, lowercase, number, and special character",{className:"toast-message"})},children:[(0,c.jsxs)("div",{className:"form-group",children:[(0,c.jsx)("label",{htmlFor:"newPassword",children:(0,c.jsx)("i",{className:"zmdi zmdi-lock-outline"})}),(0,c.jsx)("input",{type:"password",name:"newPassword",id:"newPassword",placeholder:"New Password",onChange:e=>{const s=e.target.value;P(s),R(G(s))},value:f,required:!0})]}),f&&(0,c.jsxs)("div",{className:"password-strength ".concat(S),children:[(0,c.jsx)("div",{className:"strength-bar"}),(0,c.jsxs)("span",{className:"strength-text",children:["strong"===S&&"Strong Password \u2713","medium"===S&&"Medium Strength","weak"===S&&"Weak Password","invalid"===S&&"Does not meet requirements"]})]}),(0,c.jsxs)("div",{className:"form-group",children:[(0,c.jsx)("label",{htmlFor:"confirmPassword",children:(0,c.jsx)("i",{className:"zmdi zmdi-lock"})}),(0,c.jsx)("input",{type:"password",name:"confirmPassword",id:"confirmPassword",placeholder:"Confirm Password",onChange:e=>y(e.target.value),value:b,required:!0})]}),(0,c.jsxs)("div",{className:"password-requirements",children:[(0,c.jsx)("p",{children:(0,c.jsx)("strong",{children:"Password must contain:"})}),(0,c.jsxs)("ul",{children:[(0,c.jsx)("li",{className:/[A-Z]/.test(f)?"valid":"",children:"At least one uppercase letter (A-Z)"}),(0,c.jsx)("li",{className:/[a-z]/.test(f)?"valid":"",children:"At least one lowercase letter (a-z)"}),(0,c.jsx)("li",{className:/\d/.test(f)?"valid":"",children:"At least one number (0-9)"}),(0,c.jsx)("li",{className:/[!@#$%^&*()_+\-=\[\]{}|;:,.<>?]/.test(f)?"valid":"",children:"At least one special character (!@#$%^&*)"}),(0,c.jsx)("li",{className:f.length>=8?"valid":"",children:"Minimum 8 characters"})]})]}),(0,c.jsx)("div",{className:"form-group form-button",children:(0,c.jsx)("button",{type:"submit",disabled:h,children:h?(0,c.jsx)("div",{className:"spinner"}):"Set Password"})})]})]})}),C&&(0,c.jsx)("div",{className:"modal-overlay",children:(0,c.jsxs)("div",{className:"modal-content",children:[1===O&&(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)("h2",{className:"modal-title",children:"Forgot Password?"}),(0,c.jsx)("p",{className:"modal-subtitle",children:"Enter your Student ID and we'll send a password reset OTP to your registered email."}),(0,c.jsxs)("form",{onSubmit:J,children:[(0,c.jsxs)("div",{className:"form-group",children:[(0,c.jsx)("label",{htmlFor:"resetUsername",children:(0,c.jsx)("i",{className:"zmdi zmdi-account"})}),(0,c.jsx)("input",{type:"text",name:"resetUsername",id:"resetUsername",placeholder:"Student ID (e.g., WCU1234567)",onChange:e=>A(e.target.value),value:z,required:!0})]}),(0,c.jsx)("div",{className:"form-group form-button",children:(0,c.jsx)("button",{type:"submit",disabled:h,children:h?(0,c.jsx)("div",{className:"spinner"}):"Send OTP"})}),(0,c.jsx)("div",{className:"action-buttons-container",style:{justifyContent:"center"},children:(0,c.jsx)("button",{type:"button",onClick:()=>{T(!1),k(1),A("")},style:{color:"#666"},children:"Cancel"})})]})]}),2===O&&(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)("h2",{className:"modal-title",children:"Verify OTP"}),(0,c.jsxs)("p",{className:"modal-subtitle",children:["OTP sent to: ",(0,c.jsx)("strong",{children:Z})]}),(0,c.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),D){g(!0);try{const e=await o.A.post("".concat(d.C,"/verifyResetOTP"),{username:z,otp:D});e.data.success?(F(e.data.resetToken),U(e.data.userId),k(3),n.oR.success(e.data.message,{className:"toast-message"})):n.oR.error(e.data.message,{className:"toast-message"})}catch(t){var s,a;console.error("Verify reset OTP failed:",t),n.oR.error((null===(s=t.response)||void 0===s||null===(a=s.data)||void 0===a?void 0:a.message)||"Error verifying OTP",{className:"toast-message"})}finally{g(!1)}}else n.oR.error("Please enter the OTP",{className:"toast-message"})},children:[(0,c.jsxs)("div",{className:"form-group",children:[(0,c.jsx)("label",{htmlFor:"resetOTP",children:(0,c.jsx)("i",{className:"zmdi zmdi-key"})}),(0,c.jsx)("input",{type:"text",name:"resetOTP",id:"resetOTP",placeholder:"Enter 6-digit OTP",onChange:e=>q(e.target.value),value:D,maxLength:"6",required:!0})]}),(0,c.jsx)("div",{className:"form-group form-button",children:(0,c.jsx)("button",{type:"submit",disabled:h,children:h?(0,c.jsx)("div",{className:"spinner"}):"Verify OTP"})}),(0,c.jsxs)("div",{className:"action-buttons-container",children:[(0,c.jsx)("button",{type:"button",onClick:async()=>{await J({preventDefault:()=>{}})},disabled:h,children:"Resend OTP"}),(0,c.jsx)("button",{type:"button",onClick:()=>{k(1),q("")},style:{color:"#666"},children:"Change Student ID"})]})]})]}),3===O&&(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)("h2",{className:"modal-title",children:"Set New Password"}),(0,c.jsx)("p",{className:"modal-subtitle",children:"Create a strong password for your account."}),(0,c.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),!W||!M)return void n.oR.error("Please fill in all password fields",{className:"toast-message"});if(W!==M)return void n.oR.error("Passwords do not match",{className:"toast-message"});if("invalid"!==G(W)){g(!0);try{const e=await o.A.post("".concat(d.C,"/resetPassword"),{userId:E,resetToken:I,newPassword:W,confirmPassword:M});e.data.success?(n.oR.success(e.data.message,{className:"toast-message"}),T(!1),k(1),A(""),q(""),F(""),U(""),L(""),$(""),V(""),Y("")):n.oR.error(e.data.message,{className:"toast-message"})}catch(t){var s,a;console.error("Reset password failed:",t),n.oR.error((null===(s=t.response)||void 0===s||null===(a=s.data)||void 0===a?void 0:a.message)||"Error resetting password",{className:"toast-message"})}finally{g(!1)}}else n.oR.error("Password must be at least 8 characters and contain uppercase, lowercase, number, and special character",{className:"toast-message"})},children:[(0,c.jsxs)("div",{className:"form-group",children:[(0,c.jsx)("label",{htmlFor:"resetNewPassword",children:(0,c.jsx)("i",{className:"zmdi zmdi-lock-outline"})}),(0,c.jsx)("input",{type:"password",name:"resetNewPassword",id:"resetNewPassword",placeholder:"New Password",onChange:e=>{const s=e.target.value;$(s),Y(G(s))},value:W,required:!0})]}),W&&(0,c.jsxs)("div",{className:"password-strength ".concat(_),children:[(0,c.jsx)("div",{className:"strength-bar"}),(0,c.jsxs)("span",{className:"strength-text",children:["strong"===_&&"Strong Password \u2713","medium"===_&&"Medium Strength","weak"===_&&"Weak Password","invalid"===_&&"Does not meet requirements"]})]}),(0,c.jsxs)("div",{className:"form-group",children:[(0,c.jsx)("label",{htmlFor:"resetConfirmPassword",children:(0,c.jsx)("i",{className:"zmdi zmdi-lock"})}),(0,c.jsx)("input",{type:"password",name:"resetConfirmPassword",id:"resetConfirmPassword",placeholder:"Confirm Password",onChange:e=>V(e.target.value),value:M,required:!0})]}),(0,c.jsxs)("div",{className:"password-requirements",children:[(0,c.jsx)("p",{children:(0,c.jsx)("strong",{children:"Password must contain:"})}),(0,c.jsxs)("ul",{children:[(0,c.jsx)("li",{className:/[A-Z]/.test(W)?"valid":"",children:"At least one uppercase letter (A-Z)"}),(0,c.jsx)("li",{className:/[a-z]/.test(W)?"valid":"",children:"At least one lowercase letter (a-z)"}),(0,c.jsx)("li",{className:/\d/.test(W)?"valid":"",children:"At least one number (0-9)"}),(0,c.jsx)("li",{className:/[!@#$%^&*()_+\-=\[\]{}|;:,.<>?]/.test(W)?"valid":"",children:"At least one special character (!@#$%^&*)"}),(0,c.jsx)("li",{className:W.length>=8?"valid":"",children:"Minimum 8 characters"})]})]}),(0,c.jsx)("div",{className:"form-group form-button",children:(0,c.jsx)("button",{type:"submit",disabled:h,children:h?(0,c.jsx)("div",{className:"spinner"}):"Reset Password"})})]})]})]})})]})}}}]);
//# sourceMappingURL=2010.1bb72c96.chunk.js.map